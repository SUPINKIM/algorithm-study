# Git의 동작 원리

1. Git 관련 용어

- 로컬 : Working Directory(Working Copy)

  - 실제 위치 : 프로젝트 폴더
  - 현재 프로젝트 폴더에 존재하는 파일들 그 자체를 의미한다.

- 인덱스(Index) : Staging Area = Cache

  - 실제 위치 : 프로젝트 폴더 하위 .git/index 파일
  - 개념적으로는 커밋이 이뤄질 준비가 된 파일의 내용들이 위치하는 영역이며, 실제로는 하나의 파일로서 존재한다. 로컬에 변동 사항이 생겼을 경우, git add 명령어를 수행하면 해당 변동 사항을 인덱스 영역에 반영시킬 수 있다. 참고로, 인덱스 파일(.git/index)에는 커밋이 이뤄질 준비가 된 파일의 내용들 각각에 대하여 그 파일명과 해당 파일의 내용을 담고 있는 Blob 파일의 주소가 기록된다.

- 저장소(Repository)

  - 실제 위치 : 프로젝트 폴더 하위 .git/objects/ 폴더
  - 깃이 버전 관리를 하기 위해 필요로 하는 데이터들을 저장하는 곳이다. 대표적으로, 버전 관리를 시작한 시점부터 현재 시점까지 관리해 온 여러 버전들에 해당하는 파일들의 내용이 Blob 파일로서 이곳에 저장되어 있다. 이곳에 저장된 파일들을 특별히 오브젝트 파일이라고 부르며, Blob 파일도 오브젝트 파일의 한 종류이다.

- 오브젝트 파일

  - 오브젝트 파일이란 .git/objects/ 폴더에 존재하는 파일을 가리키며, 다음과 같이 분류된다.

  - Blob 파일 : 버전 관리하는 파일들 각각의 내용은 깃의 저장소에서 Blob 파일의 형태로 저장된다. 파일의 내용에 SHA1이라는 해싱 기법을 적용하여 Blob 파일의 이름을 얻어내기 때문에, 내용이 같은 파일들은 모두 하나의 Blob 파일로서 저장된다. 이러한 원리로 깃은 여러 버전에 걸쳐 존재하는 파일들의 내용을 중복 없이 관리할 수 있게 된다.

  - Commit 파일 : 하나의 버전을 생성한다는 것은 하나의 Commit 파일을 만드는 것을 의미한다. Commit 파일은 하나의 Tree 파일을 가리키게 되어 있다. 이 파일에는 가리키고 있는 Tree 파일의 주소와 직전 버전에 해당하는 Commit 파일의 주소가 기록된다.

  - Tree 파일 : 커밋 시점의 파일들 각각에 대해 그 파일명과 해당 파일의 내용을 담고 있는 Blob 파일의 주소(이름)가 기록된다. 인덱스 파일(.git/index)과 성격이 유사하다.

  - Tag 파일

2. Git 브랜치

- HEAD

  - 실제 위치 : .git/HEAD
  - 현재 체크아웃 되어 있는 브랜치의 포인터를 가리키는 포인터이다. 브랜치의 포인터가 아닌, 일반적인 Commit 파일을 가리키게 할 수도 있다.(이런 경우 detached HEAD라고 표현된다.)

- 브랜치 포인터
  - .git/refs/heads/{브랜치명}
  - 해당 브랜치의 가장 최신 Commit 파일을 가리키는 포인터이다.

---

🙏 참고 자료

> [[Git] 내부 동작 원리에 대한 이해](https://it-eldorado.tistory.com/4)

---

✅ 더 공부해야 할 것들
